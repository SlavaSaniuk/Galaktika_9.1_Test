//******************************************************************************
// ШАПКА НАКЛАДНОЙ
#include TN2_090.frn
//******************************************************************************



//******************************************************************************
// ТАБЛИЦА СО СПЕЦИФИКАЦИЕЙ
//******************************************************************************

#ifdef _IN_VAL_DOC_
  // Наименование валюты
  НакСимвол НакСимвол НакСимвол НакСимвол
#end
//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ВЕРХНИЙ КОЛОНТИТУЛ
//******************************************************************************

  // номер накладной
  if (isNumNakl, Номер, '')

  // дата создание накладной
  DateToStr(Дата,'DD mon YYYY г.')

  // номер страницы
  strNN

  // Грузоотправитель
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 2)
  oPrnSoprFun.TTNBelSelfAddr (Грузоотправитель, Грузоотправитель_ЮрАдрес, Грузоотправитель_Адрес, Поставщик, Поставщик_Адрес, Склад, Склад_Адрес, 1)

  // Грузоотправитель - головная организация
#ifndef _TTN_2009F_
  + ' ' +
#end
  oPrnSoprFun.GetParentOrg(Грузоотправитель_Головная_Орг_Наимен)

  // Грузополучатель
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 2)
  oPrnSoprFun.TTNBelAddr (Грузополучатель, Грузополучатель_ЮрАдрес, Грузополучатель_Адрес, Поставщик, Поставщик_Адрес, Склад_Пол, Склад_Пол_Адрес, 1)

  // Грузополучатель - головная организация
#ifndef _TTN_2009F_
  + ' ' +
#end
  oPrnSoprFun.GetParentOrg(Грузополучатель_Головная_Орг_Наимен)
//******************************************************************************



//******************************************************************************
// ШАПКА НАКЛАДНОЙ
//******************************************************************************

#ifdef _IN_VAL_DOC_
  // Наименование валюты
  НакСимвол НакСимвол НакСимвол НакСимвол
#end
//******************************************************************************



//******************************************************************************
// СПЕЦИФИКАЦИЯ. ОСНОВНАЯ СТРОКА
//******************************************************************************

  // Графа 1. Наименование товара
  Название_Доп

  // Графа 2. Единица измерения
  ОтпЕд

  // Графа 3. Количество
  DoubleToStr(КолФ, Kol_Pr)

  // Графа 4. Цена
  oPrnSoprFun.GetSPriceMC(спецификацияМЦ_нрек, 0, Валюта_нрек, Признак_МЦ, ЦНацСН, ЦНацБН, ЦНакСН, ЦНакБН)

  // Графа 5. Стоимость
  oPrnSoprFun.GetSSummaMC(0, Признак_МЦ, СтНацСН0, СтНацБН0, СтНакСН, СтНакБН)

  // Графа 6. Ставка НДС
  oPrnSoprFun.GetStavkaNal(ПризнакНДС, ставка_первого_налога)

  // Графа 7. Сумма НДС
  oPrnSoprFun.GetSumNds(0,ПризнакНДС, СтНДСНац0, СтНДСНак)

  // Графа 8. Стоимость с НДС
  oPrnSoprFun.GetSSummaMCsNDS(0, СтНацСН0, СтНакСН)

  // Графа 9. Примечание
  if (isValDoc, sPrimechanieV, sPrimechanie)

#ifdef _TTN_AKTREC_
  + if (isReklNaklNum, oPrnSoprFun.GetNumNaklPrim(спецификацияМЦ_нрек), '')
#end

//******************************************************************************



//******************************************************************************
// СПЕЦИФИКАЦИЯ. ДОПОЛНИТЕЛЬНАЯ СТРОКА.
// Выводится по флагу из интерфейса "Документоы следуемые с грузом"
//******************************************************************************

  // Графа 1. Наименование товара
  Название_Доп

  // Графа 2. Единица измерения
  ОтпЕд

  // Графа 3. Количество
  DoubleToStr(КолФ, Kol_Pr)

  // Графа 4. Цена
  oPrnSoprFun.GetSPriceMC(спецификацияМЦ_нрек, 0, Валюта_нрек, Признак_МЦ, ЦНацСН, ЦНацБН, ЦНакСН, ЦНакБН)

  // Графа 5. Стоимость
  oPrnSoprFun.GetSSummaMC(0, Признак_МЦ, СтНацСН0, СтНацБН0, СтНакСН, СтНакБН)

  // Графа 6. Ставка НДС
  oPrnSoprFun.GetStavkaNal(ПризнакНДС, ставка_первого_налога)

  // Графа 7. Сумма НДС
  oPrnSoprFun.GetSumNds(0,ПризнакНДС, СтНДСНац0, СтНДСНак)

  // Графа 8. Стоимость с НДС
  oPrnSoprFun.GetSSummaMCsNDS(0, СтНацСН0, СтНакСН)

  // Графа 9. Примечание
  if (isValDoc, sPrimechanieV, sPrimechanie)

#ifdef _TTN_AKTREC_
  + if (isReklNaklNum, oPrnSoprFun.GetNumNaklPrim(спецификацияМЦ_нрек), '')
#end

  // первая часть дополнительной строки
  с_грузом_след_док_доп

  // вторая часть дополнительной строки
  с_грузом_след_док_доп2

//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. НИЖНИЙ КОЛОНТИТУЛ
//******************************************************************************
  // Итог по странице. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(strОтпЕд, Kol_Pr), ' ')

#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), strАСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), Cena_Pr)
#end

  // Итог по странице. Графа 7. Сумма НДС
  DoubleToStr(strАНДСНац,  Cena_Pr)

  // Итог по странице. Графа 8. Стоимость с НДС
  DoubleToStr(strАСтНацСН, Cena_Pr)

  // Итог по странице. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по странице. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по странице. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по странице. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp(сдал_отправитель_должность, сдал_отправитель)

  // Итог по странице. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin(ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по странице. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover(НомерДовер, ДатаДовер)

  // Итог по странице. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. НИЖНИЙ КОЛОНТИТУЛ
//******************************************************************************
  // Итоговый лист. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(strОтпЕд, Kol_Pr), ' ')

  // Итог по странице. Графа 5. Стоимость. Для розничных накладных стоимость с налогами.
#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), strАСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), Cena_Pr)
#end

  // Итог по странице. Графа 7. Сумма НДС
  DoubleToStr(strАНДСНац,  Cena_Pr)

  // Итог по странице. Графа 8. Стоимость с НДС
  DoubleToStr(strАСтНацСН, Cena_Pr)

  // Итог по странице. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по странице. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по странице. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по странице. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp(сдал_отправитель_должность, сдал_отправитель)

  // Итог по странице. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin(ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по странице. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover(НомерДовер, ДатаДовер)

  // Итог по странице. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ИТОГО ПО НАКЛАДНОЙ
//******************************************************************************

  // Итоговый лист. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(sumОтпЕд, Kol_Pr), ' ')

#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), АСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), Cena_Pr)
#end

  // Итог по накладной. Графа 7. Сумма НДС
  DoubleToStr(АНДСНац,  Cena_Pr)

  // Итог по накладной. Графа 8. Стоимость с НДС
  DoubleToStr(АСтНацСН, Cena_Pr)

//******************************************************************************



//******************************************************************************
// АКЦИЗНЫЕ МАРКИ
//******************************************************************************
#ifdef _TTN_ALC_
  // номер накладной
  if(isNumNakl, Номер, '')

  // дата создания накладной
  DateToStr(Дата,'DD mon YYYY г.')

  // номер страницы
  strNN

  // наименование МЦ
  Название2

  // удостоверение о гигиенической регистрации
  удост_госгигиен_регистрации2

  // таможенное разрешение
  таможенные_разрешения2

  // акцизные марки
  акцизные_марки1 акцизные_марки2 акцизные_марки3 акцизные_марки4 акцизные_марки5
  акцизные_марки6 акцизные_марки7 акцизные_марки8 акцизные_марки9 акцизные_марки10
#end
//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ИТОГОВЫЙ ЛИСТ
//******************************************************************************

  // Шапка накладной
  #include TN2_090.frn

  // Итоговый лист. Название валюта
#ifdef _IN_VAL_DOC_
  НакСимвол НакСимвол НакСимвол НакСимвол
#end

  // Итоговый лист. Номер накладной
  if(isNumNakl, Номер, '')

  // Итоговый лист. Дата накладной
  DateToStr(Дата,'DD mon YYYY г.')

  // Итоговый лист. Число страниц
  strNN

  // Итоговый лист. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(sumОтпЕд, Kol_Pr), ' ')

  // Итоговый лист. Графа 5. Стоимость. Для розничных накладных стоимость с налогами
#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), АСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), Cena_Pr)
#end

  // Итоговый лист. Графа 7. Сумма НДС
  DoubleToStr(АНДСНац,  Cena_Pr)

  // Итоговый лист. Графа 8. Стоимость с НДС
  DoubleToStr(АСтНацСН, Cena_Pr)

  // Итоговый лист. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итоговый лист. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итоговый лист. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по накладной. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp(сдал_отправитель_должность, сдал_отправитель)

  // Итог по накладной. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin(ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по накладной. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover(НомерДовер, ДатаДовер)

  // Итог по накладной. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

  // С товаром переданы документы. Документы, поставляемые с грузом. 1-я строка.
  if (bDocEveryStr, '', все_документы1)

  // С товаром переданы документы. Документы, поставляемые с грузом. 2-я строка.
  if (bDocEveryStr, '', все_документы2)

  // С товаром переданы документы. Документы, поставляемые с грузом. 3-я строка.
  if (bDocEveryStr, '', все_документы3)

  // С товаром переданы документы. Документы, поставляемые с грузом. 4-я строка.
  if (bDocEveryStr, '', все_документы4)

  // С товаром переданы документы. Документы, поставляемые с грузом. 5-я строка.
  if (bDocEveryStr, '', все_документы5)

  // С товаром переданы документы. Сертификаты партий. 1-я строка.
  if (bDocEveryStr, '',
    if (все_сертификаты1 = '', '', ' Сертификаты: ' + все_сертификаты1))

  // С товаром переданы документы. Сертификаты партий. 2-я строка.
  if (bDocEveryStr, '', все_сертификаты2)

  // С товаром переданы документы. Сертификаты партий. 3-я строка.
  if (bDocEveryStr, '', все_сертификаты3)

  // С товаром переданы документы. Сертификаты партий. 4-я строка.
  if (bDocEveryStr, '', все_сертификаты4)

  // С товаром переданы документы. Сертификаты партий. 5-я строка.
  if (bDocEveryStr, '', все_сертификаты5)

  // С товаром переданы документы. Прейскурант цен.
  if (ПрейскурантЦен  = '', '', ' Прейскурант: ' + Trim(ПрейскурантЦен))

  // С товаром переданы документы. Прайс-листы.
  if (bDocEveryStr, '',
    if (все_прайслисты = '', '', все_прайслисты))
//******************************************************************************

  // Символ-разделитель страниц.
  Спецсимвол
