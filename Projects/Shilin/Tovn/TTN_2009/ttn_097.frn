!…ƒ“‹“…€ ‘’€‚€ „‘ ‚ ’—…’€•
.begin
  if (not DocTuneNDS)
    Exit;

  if FASTREPORTMEM.getfirst SpSoprMemTTN where  ((α―¥ζ¨δ¨ ζ¨ο–_­ΰ¥ == SpSoprMemTTN.nREC)) <> tsOk
    Exit;

  if FASTREPORTMEM.getfirst KatMC where ((FASTREPORTMEM.SpSoprMemTTN.cMCUSL == KatMC.Nrec)) <> tsOK
    Exit;

  var piExAttr  : iExtAttr;
  var δ¨α¨ΰ®Ά ­­ ο_αβ Ά :double;

  δ¨α¨ΰ®Ά ­­ ο_αβ Ά  := piExAttr.doGetAttr(coKatMC, FASTREPORTMEM.KatMc.NRec, '…ƒ“‹“…€ ‘’€‚€ „‘ ‚ ’—…’€•');

  if (δ¨α¨ΰ®Ά ­­ ο_αβ Ά  <> 0)
  {
    αβ Ά _―¥ΰΆ®£®_­ «®£  := δ¨α¨ΰ®Ά ­­ ο_αβ Ά ;

    if (KatSoprVhodNal = 1)//­ «®£¨ Άε®¤οβ
    {
      ‘β ζ0 := ‘β ζ‘0;

      if (isValDoc)
        ‘β  := ‘β ‘;
    }
    else
    {
      ‘β ζ‘0 := ‘β ζ0;

      if (isValDoc)
        ‘β ‘ := ‘β ;
    }
  }
end.
