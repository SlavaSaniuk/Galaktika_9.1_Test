//******************************************************************************
// ШАПКА НАКЛАДНОЙ
#include TTN_092.frn
//******************************************************************************



//******************************************************************************
// ТАБЛИЦА СО СПЕЦИФИКАЦИЕЙ
//******************************************************************************

#ifdef _IN_VAL_DOC_
  // Наименование валюты
  НакСимвол НакСимвол НакСимвол НакСимвол
#end

#ifndef _TTN_ALC_
  // наименование единицы массы
  oPrnSoprFun.GetwRoundMass2StrTTN
#end
//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ВЕРХНИЙ КОЛОНТИТУЛ
//******************************************************************************

  // номер накладной
  if (isNumNakl, Номер, '')

  // дата создание накладной
  DateToStr(Дата,'DD mon YYYY г.')

  // номер страницы
  strNN

  // заказчик автомобильной перевозки
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 5, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 5, 2)
  oPrnSoprFun.TTNBelPlatAddr(Заказчик_Плательщик, Заказчик_Плательщик_ЮрАдрес, Заказчик_Плательщик_Адрес, Поставщик, Поставщик_Адрес, '', '', 0)

  // Грузоотправитель
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 2)
  oPrnSoprFun.TTNBelSelfAddr (Грузоотправитель, Грузоотправитель_ЮрАдрес, Грузоотправитель_Адрес, Поставщик, Поставщик_Адрес, Склад, Склад_Адрес, 1)

  // Грузоотправитель - головная организация
  oPrnSoprFun.GetParentOrg (Грузоотправитель_Головная_Орг_Наимен)

  // Грузополучатель
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 2)
  oPrnSoprFun.TTNBelAddr (Грузополучатель, Грузополучатель_ЮрАдрес, Грузополучатель_Адрес, Поставщик, Поставщик_Адрес, Склад_Пол, Склад_Пол_Адрес, 1)

  // Грузополучатель - головная организация
  oPrnSoprFun.GetParentOrg (Грузополучатель_Головная_Орг_Наимен)
//******************************************************************************



//******************************************************************************
// ШАПКА НАКЛАДНОЙ
//******************************************************************************

#ifdef _IN_VAL_DOC_
  // Наименование валюты
  НакСимвол НакСимвол НакСимвол НакСимвол
#end

#ifndef _TTN_ALC_
  // наименование единицы массы
  oPrnSoprFun.GetwRoundMass2StrTTN
#end
//******************************************************************************



//******************************************************************************
// СПЕЦИФИКАЦИЯ. ОСНОВНАЯ СТРОКА
//******************************************************************************

#ifdef _TTN_2009R_
  // специализированная форма для розницы с налогом с продаж
  Номер_пп
#end

  // Графа 1. Наименование товара
  Название_Доп

  // Графа 2. Единица измерения
  ОтпЕд

  // Графа 3. Количество
  DoubleToStr(КолФ, Kol_Pr)

  // Графа 4. Цена
  oPrnSoprFun.GetSPriceMC (спецификацияМЦ_нрек, 0, Валюта_нрек, Признак_МЦ, ЦНацСН, ЦНацБН, ЦНакСН, ЦНакБН)

  // Графа 5. Стоимость
  oPrnSoprFun.GetSSummaMC (0, Признак_МЦ, СтНацСН0, СтНацБН0, СтНакСН, СтНакБН)

  // Графа 6. Ставка НДС
  oPrnSoprFun.GetStavkaNal (ПризнакНДС, ставка_первого_налога)

  // Графа 7. Сумма НДС
  oPrnSoprFun.GetSumNds (0, ПризнакНДС, СтНДСНац0, СтНДСНак)

#ifdef _TTN_2009R_
  // специализированная форма для розницы с налогом с продаж
  DoubleToStr(ВсегоНДС9, Cena_PrR)
  if (СтавкаНП10 = 0, '', DoubleToStr(СтавкаНП10, '66.88'))
  DoubleToStr(СуммаНП11, Cena_PrR)
  DoubleToStr(ВсегоНДСНП12, Cena_PrR)
  DoubleToStr(РознЦена13, Cena_PrR)
#else
  // Графа 8. Стоимость с НДС
  oPrnSoprFun.GetSSummaMCsNDS (0, СтНацСН0, СтНакСН)
#end

  // Графа 9. Кол-во грузовых мест
  oPrnSoprFun.GetKolGrM (Признак_МЦ, КОЛ_ГРУЗОВЫХ_МЕСТ, КолФ)

  // Графа 10. Масса груза
#ifdef _TTN_ALC_
  oPrnSoprFun.GetMassaBr (Признак_МЦ, КолВес)
#else
  oPrnSoprFun.GetMassaBrTTN (Признак_МЦ, КолВес)
#end
  // Графа 11. Примечание
  if (isValDoc, sPrimechanieV, sPrimechanie)

#ifdef _TTN_AKTREC_
  + if (isReklNaklNum, oPrnSoprFun.GetNumNaklPrim(спецификацияМЦ_нрек), '')
#end

//******************************************************************************



//******************************************************************************
// СПЕЦИФИКАЦИЯ. ДОПОЛНИТЕЛЬНАЯ СТРОКА.
// Выводится по флагу из интерфейса "Документоы следуемые с грузом"
//******************************************************************************

#ifdef _TTN_2009R_
  // специализированная форма для розницы с налогом с продаж
  Номер_пп
#end
  // Графа 1. Наименование товара
  Название_Доп

  // Графа 2. Единица измерения
  ОтпЕд

  // Графа 3. Количество
  DoubleToStr(КолФ, Kol_Pr)

  // Графа 4. Цена
  oPrnSoprFun.GetSPriceMC (спецификацияМЦ_нрек, 0, Валюта_нрек, Признак_МЦ, ЦНацСН, ЦНацБН, ЦНакСН, ЦНакБН)

  // Графа 5. Стоимость
  oPrnSoprFun.GetSSummaMC (0, Признак_МЦ, СтНацСН0, СтНацБН0, СтНакСН, СтНакБН)

  // Графа 6. Ставка НДС
  oPrnSoprFun.GetStavkaNal (ПризнакНДС, ставка_первого_налога)

  // Графа 7. Сумма НДС
  oPrnSoprFun.GetSumNds (0, ПризнакНДС, СтНДСНац0, СтНДСНак)

#ifdef _TTN_2009R_
  // специализированная форма для розницы с налогом с продаж
  DoubleToStr(ВсегоНДС9, Cena_PrR)
  if (СтавкаНП10 = 0, '', DoubleToStr(СтавкаНП10, '66.88'))
  DoubleToStr(СуммаНП11   , Cena_PrR)
  DoubleToStr(ВсегоНДСНП12, Cena_PrR)
  DoubleToStr(РознЦена13  , Cena_PrR)
#else
  // Графа 8. Стоимость с НДС
  oPrnSoprFun.GetSSummaMCsNDS (0, СтНацСН0, СтНакСН)
#end

  // Графа 9. Кол-во грузовых мест
  oPrnSoprFun.GetKolGrM (Признак_МЦ, КОЛ_ГРУЗОВЫХ_МЕСТ, КолФ)

  // Графа 10. Масса груза
#ifdef _TTN_ALC_
  oPrnSoprFun.GetMassaBr (Признак_МЦ, КолВес)
#else
  oPrnSoprFun.GetMassaBrTTN (Признак_МЦ, КолВес)
#end

  // Графа 11. Примечание
  if (isValDoc, sPrimechanieV, sPrimechanie)

#ifdef _TTN_AKTREC_
  + if (isReklNaklNum, oPrnSoprFun.GetNumNaklPrim(спецификацияМЦ_нрек), '')
#end

  // первая часть дополнительной строки
  с_грузом_след_док_доп

  // вторая часть дополнительной строки
  с_грузом_след_док_доп2

//******************************************************************************



//******************************************************************************
#ifdef _TTN_2009R_
  // специализированная форма для розницы с налогом с продаж
  ДрагМетНазв[1]   ДрагМетКол[1]   ДрагМетЕд[1]
  ДрагМетНазв[2]   ДрагМетКол[2]   ДрагМетЕд[2]
  ДрагМетНазв[3]   ДрагМетКол[3]   ДрагМетЕд[3]
  ДрагМетНазв[4]   ДрагМетКол[4]   ДрагМетЕд[4]
  ДрагМетНазв[5]   ДрагМетКол[5]   ДрагМетЕд[5]
  ДрагМетНазв[6]   ДрагМетКол[6]   ДрагМетЕд[6]
  ДрагМетНазв[7]   ДрагМетКол[7]   ДрагМетЕд[7]
  ДрагМетНазв[8]   ДрагМетКол[8]   ДрагМетЕд[8]
  ДрагМетНазв[9]   ДрагМетКол[9]   ДрагМетЕд[9]
  ДрагМетНазв[10]  ДрагМетКол[10]  ДрагМетЕд[10]
#end
//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. НИЖНИЙ КОЛОНТИТУЛ
//******************************************************************************
  // Итог по странице. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(strОтпЕд, Kol_Pr), ' ')

#ifndef _TTN_2009R_
  // Итог по графе 5. Стоимость. Для розничных накладных стоимость с налогами.
#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), strАСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), Cena_Pr)
#end

  // Итог по странице. Графа 7. Сумма НДС
  DoubleToStr(strАНДСНац,  Cena_Pr)

  // Итог по странице. Графа 8. Стоимость с НДС
  DoubleToStr(strАСтНацСН, Cena_Pr)

  // Итог по странице. Графа 9. Кол-во грузовых мест
  DoubleToStr(strАКолФ, RoundGrm)

  // Итог по странице. Графа 10. Масса груза
#ifdef _TTN_ALC_
  DoubleToStr(strАКолВес, Massa_Kg)
#else
  MassaBrutto(strАКолВес, wRoundMass2)
#end

  // Итог по странице. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по странице. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

#else
  DoubleToStr(АСтоимость6  , Cena_Pr)
  DoubleToStr(АСуммаНДС8   , Cena_Pr)
  DoubleToStr(АВсегоНДС9   , Cena_Pr)
  DoubleToStr(АСуммаНП11   , Cena_Pr)
  DoubleToStr(АВсегоНДСНП12, Cena_Pr)
  DoubleToStr(strАКолФ     , RoundGrm)
  MassaBrutto(strАКолВес   , wRoundMass2)
  DoubleToString(0, Round(АСуммаНДС8   , GetPrecisionGroup('brForSopr_Price')))
  DoubleToString(0, Round(АВсегоНДСНП12, GetPrecisionGroup('brForSopr_Price')))
#end

  // Итог по странице. Масса груза по странице
#ifdef _TTN_ALC_
  if (strАКолВес = 0, '', MassaInWords (strАКолВес, if (wRoundMass2 > 3, wRoundMass2, 3)))
#else
  if (strАКолВес = 0, '', MassaInWords (strАКолВес, wRoundMass2))
#end

  // Итог по странице. Кол-во грузовых мест
  DoubleToStr(Round(strАКолФ, KolZn), strDr)

  // Итог по странице. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz (отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по странице. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin (ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по странице. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp (сдал_отправитель_должность, сдал_отправитель)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

  // Итог по странице. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover (НомерДовер, ДатаДовер)

  // Итог по странице. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. НИЖНИЙ КОЛОНТИТУЛ
//******************************************************************************
  // Итог по странице. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(strОтпЕд, Kol_Pr), ' ')

  // Итог по странице. Графа 5. Стоимость. Для розничных накладных стоимость с налогами.
#ifndef _TTN_2009R_
#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), strАСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, strАСтНацСБН, strАСтНацБН), Cena_Pr)
#end

  // Итог по странице. Графа 7. Сумма НДС
  DoubleToStr(strАНДСНац, Cena_Pr)

  // Итог по странице. Графа 8. Стоимость с НДС
  DoubleToStr(strАСтНацСН, Cena_Pr)

  // Итог по странице. Графа 9. Кол-во грузовых мест
  DoubleToStr(strАКолФ, RoundGrm)

  // Итог по странице. Графа 10. Масса груза
#ifdef _TTN_ALC_
  DoubleToStr(strАКолВес, Massa_Kg)
#else
  MassaBrutto(strАКолВес, wRoundMass2)
#end

  // Итог по странице. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по странице. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(strАСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

#else
  // специализированная форма для розницы с налогом с продаж
  DoubleToStr(АСтоимость6  , Cena_Pr)
  DoubleToStr(АСуммаНДС8   , Cena_Pr)
  DoubleToStr(АВсегоНДС9   , Cena_Pr)
  DoubleToStr(АСуммаНП11   , Cena_Pr)
  DoubleToStr(АВсегоНДСНП12, Cena_Pr)
  DoubleToStr(strАКолФ     , RoundGrm)
  MassaBrutto(strАКолВес   , wRoundMass2)
  DoubleToString(0, Round(АСуммаНДС8   , GetPrecisionGroup('brForSopr_Price')))
  DoubleToString(0, Round(АВсегоНДСНП12, GetPrecisionGroup('brForSopr_Price')))
#end

  // Итог по странице. Масса груза прописью
#ifdef _TTN_ALC_
  if (strАКолВес = 0, '', MassaInWords (strАКолВес, if (wRoundMass2 > 3, wRoundMass2, 3)))
#else
  if (strАКолВес = 0, '', MassaInWords (strАКолВес, wRoundMass2))
#end

  // Итог по странице. Кол-во грузовых мест прописью
  DoubleToStr(Round(strАКолФ, KolZn), strDr)

  // Итог по странице. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz (отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по странице. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin (ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по странице. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp (сдал_отправитель_должность, сдал_отправитель)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

  // Итог по странице. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover (НомерДовер, ДатаДовер)

  // Итог по странице. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ИТОГО ПО НАКЛАДНОЙ
//******************************************************************************
  // Итоговый лист. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(sumОтпЕд, Kol_Pr), ' ')

  // Итог по накладной. Графа 5. Стоимость. Для розничных накладных стоимость с налогами.
#ifndef _TTN_2009R_
#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), АСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), Cena_Pr)
#end

  // Итог по накладной. Графа 7. Сумма НДС
  DoubleToStr(АНДСНац,  Cena_Pr)

  // Итог по накладной. Графа 8. Стоимость с НДС
  DoubleToStr(АСтНацСН, Cena_Pr)

  // Итог по накладной. Графа 9. Кол-во грузовых мест
  if ((KolGrM = '') AND (sumKolf = 0), '', DoubleToStr(sumKolf, RoundGrm))

  // Итог по накладной. Графа 10. Масса груза
#ifdef _TTN_ALC_
  DoubleToStr(sumves, Massa_Kg)
#else
  MassaBrutto(sumves, wRoundMass2)
#end
#else
  // специализированная форма для розницы с налогом с продаж
  DoubleToStr(АСтоимость6  , Cena_Pr)
  DoubleToStr(АСуммаНДС8   , Cena_Pr)
  DoubleToStr(АВсегоНДС9   , Cena_Pr)
  DoubleToStr(АСуммаНП11   , Cena_Pr)
  DoubleToStr(АВсегоНДСНП12, Cena_Pr)
  DoubleToStr(sumkolf      , RoundGrm)
  MassaBrutto(sumves       , wRoundMass2)
#end

  // Итог по накладной. Графа 10. Масса груза
  DoubleToStr(количество_ездок, '666')

!------------------------------------------------------------------------------
!вывод данных с оборотной страницы на 1-ю по настройке
!------------------------------------------------------------------------------
  // Итог по накладной. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по накладной. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по накладной. Масса груза прописью
#ifdef _TTN_ALC_
  if (sumves = 0, '', MassaInWords (sumves, if (wRoundMass2 > 3, wRoundMass2, 3)))
#else
  if (sumves = 0, '', MassaInWords (sumves, wRoundMass2))
#end

  // Итог по накладной. Кол-во грузовых мест прописью
  DoubleToStr(Round(sumkolf, KolZn), strDr)

  // Итог по накладной. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz (отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по накладной. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin (ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по накладной. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp (сдал_отправитель_должность, сдал_отправитель)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

  // Итог по накладной. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover (НомерДовер, ДатаДовер)

  // Итог по накладной. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

!------------------------------------------------------------------------------
//******************************************************************************



//******************************************************************************
// АКЦИЗНЫЕ МАРКИ
//******************************************************************************
#ifdef _TTN_ALC_
  // номер накладной
  if (isNumNakl, Номер, '')

  // дата создания накладной
  DateToStr(Дата,'DD mon YYYY г.')

  // номер страницы
  strNN

  // наименование МЦ
  Название2

  // удостоверение о гигиенической регистрации
  удост_госгигиен_регистрации2

  // таможенное разрешение
  таможенные_разрешения2

  // акцизные марки
  акцизные_марки1 акцизные_марки2 акцизные_марки3 акцизные_марки4 акцизные_марки5
  акцизные_марки6 акцизные_марки7 акцизные_марки8 акцизные_марки9 акцизные_марки10
#end
//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ИТОГОВЫЙ ЛИСТ
//******************************************************************************

  // Шапка накладной
  #include TTN_092.frn

  // Итоговый лист. Название валюта
#ifdef _IN_VAL_DOC_
  НакСимвол НакСимвол НакСимвол НакСимвол
#end

  // Итоговый лист. Название единицы массы
#ifndef _TTN_ALC_
  oPrnSoprFun.GetwRoundMass2StrTTN()
#end

  // Итоговый лист. Номер накладной
  if (isNumNakl, Номер, '')

  // Итоговый лист. Дата накладной
  DateToStr(Дата,'DD mon YYYY г.')

  // Итоговый лист. Число страниц
  strNN

  // Итоговый лист. Количество.
  if (oPrnSoprFun.IsSumOtpEd(накладная_нрек), DoubleToStr(sumОтпЕд, Kol_Pr), ' ')

  // Итоговый лист. Графа 5. Стоимость. Для розничных накладных стоимость с налогами
#ifndef _TTN_2009R_
#ifdef _TTN_DOC_ROZN_
  DoubleToStr (if (isRozn911, if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), АСтНацСН), Cena_Pr)
#else
  DoubleToStr (if (bNalProd OR bFixGrMC, АСтНацСБН, АСтНацБН), Cena_Pr)
#end

  // Итоговый лист. Графа 7. Сумма НДС
  DoubleToStr(АНДСНац,  Cena_Pr)

  // Итоговый лист. Графа 8. Стоимость с НДС
  DoubleToStr(АСтНацСН, Cena_Pr)

  // Итоговый лист. Графа 9. Кол-во грузовых мест
  if ((KolGrM = '') AND (sumKolf = 0), '', DoubleToStr(sumKolf, RoundGrm))

  // Итоговый лист. Графа 10. Масса груза
#ifdef _TTN_ALC_
  DoubleToStr(sumves, Massa_Kg)
#else
  MassaBrutto(sumves, wRoundMass2)
#end

  // Итоговый лист. Кол-во ездок
  DoubleToStr(количество_ездок, '666')

!------------------------------------------------------------------------------
!вывод данных с оборотной страницы на 1-ю по настройке
!------------------------------------------------------------------------------
  // Итоговый лист. Сумма НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итоговый лист. Всего с НДС прописью
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итоговый лист. Масса груза прописью
#ifdef _TTN_ALC_
  if (sumves = 0, '', MassaInWords (sumves, if (wRoundMass2 > 3, wRoundMass2, 3)))
#else
  if (sumves = 0, '', MassaInWords (sumves, wRoundMass2))
#end

  // Итоговый лист. Кол-во грузовых мест прописью
  DoubleToStr(Round(sumkolf, KolZn), strDr)

  // Итоговый лист. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz (отпуск_разрешил_должность, отпуск_разрешил)

  // Итоговый лист. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin (ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итоговый лист. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp (сдал_отправитель_должность, сдал_отправитель)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

  // Итоговый лист. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover (НомерДовер, ДатаДовер)

  // Итоговый лист. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

//------------------------------------------------------------------------------
//******************************************************************************



//******************************************************************************
// МНОГОСТРАНИЧНАЯ НАКЛАДНАЯ. ИТОГО ПО НАКЛАДНОЙ
//******************************************************************************

  // Итог по накладной. Графа 5. Стоимость. Для розничных накладных стоимость с налогами.
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АНДСНац, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))

  // Итог по накладной. Графа 7. Сумма НДС
  DoubleToString(if (isValDoc, Валюта_нрек, 0),
                 Round(АСтНацСН, GetPrecisionGroup(if (isValDoc, 'brForSopr_RVPrice', 'brForSopr_Price'))))
#else
  // специализированная форма для розницы с налогом с продаж
  DoubleToStr(АСтоимость6  , Cena_Pr)
  DoubleToStr(АСуммаНДС8   , Cena_Pr)
  DoubleToStr(АВсегоНДС9   , Cena_Pr)
  DoubleToStr(АСуммаНП11   , Cena_Pr)
  DoubleToStr(АВсегоНДСНП12, Cena_Pr)
  DoubleToStr(sumkolf      , RoundGrm)
  MassaBrutto(sumves       , wRoundMass2)
  DoubleToStr(количество_ездок, '666')
  DoubleToString(0, Round(АСуммаНДС8   , GetPrecisionGroup('brForSopr_Price')))
  DoubleToString(0, Round(АВсегоНДСНП12, GetPrecisionGroup('brForSopr_Price')))
#end

  // Итог по накладной. Масса груза прописью
#ifdef _TTN_ALC_
  if (sumves = 0, '', MassaInWords (sumves, if (wRoundMass2 > 3, wRoundMass2, 3)))
#else
  if (sumves = 0, '', MassaInWords (sumves, wRoundMass2))
#end

  // Итог по накладной. Кол-во грузовых мест прописью
  DoubleToStr(Round(sumkolf, KolZn), strDr)

  // Итог по накладной. Отпуск разрешил
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность3, отпуск_разрешил3), '')
  if (DopOtpRaz, oPrnSoprFun.GetOtpRaz(отпуск_разрешил_должность2, отпуск_разрешил2), '')
  oPrnSoprFun.GetOtpRaz (отпуск_разрешил_должность, отпуск_разрешил)

  // Итог по накладной. Товар к перевозке принял
  oPrnSoprFun.GetTovPrin (ФИОДовер, Экспедитор, ДовЛицоДолжность)

  // Итог по накладной. Сдал грузоотправитель
  oPrnSoprFun.GetSdalOtp (сдал_отправитель_должность, сдал_отправитель)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

  // Итог по накладной. Дата доверенность
  oPrnSoprFun.GetNumAndDateDover (НомерДовер, ДатаДовер)

  // Итог по накладной. Организация выдавшая доверенность
  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  // Итог по странице. Принял грузополучатель
  oPrnSoprFun.GetPrGrpol(накладная_нрек)

  // номер пломбы
  oPrnSoprFun.GetPlomba(накладная_нрек)

//******************************************************************************



//******************************************************************************
// РАЗДЕЛ II. ПОГРУЗОЧНО-РАЗГРУЗОЧНЫЕ ОПЕРАЦИИ
//******************************************************************************

  // Транспортная услуга. 1-я
  транспортная_услуга_1

  // Транспортная услуга. 2-я
  транспортная_услуга_2

  // Погрузка. Исполнитель
  ТТН_ПунктП_Орг_Имя

  // Погрузка. Способ
  ТТН_ПунктП_Метод

  // Погрузка. Дата прибытия
  oPrnSoprFun.GetDateInF (ТТН_ПунктП_Дата_С)

  // Погрузка. Время прибытия
  oPrnSoprFun.GetTimeInF (ТТН_ПунктП_Время_С)

  // Погрузка. Дата убытия
  oPrnSoprFun.GetDateInF (ТТН_ПунктП_Дата_По)

  // Погрузка. Время убытия
  oPrnSoprFun.GetTimeInF (ТТН_ПунктП_Время_По)

  // Погрузка. Время дополнительной операции
  oPrnSoprFun.GetTimeInF (ТТН_ПунктП_Доп_Время)

  // Погрузка. Наименование дополнительной операции
  ТТН_ПунктП_Доп_Имя

  // Разгрузка. Исполнитель
  ТТН_ПунктР_Орг_Имя

  // Погрузка. Способ
  ТТН_ПунктР_Метод

  // С товаром переданы документы. Документы, поставляемые с грузом. 1-я строка.
  if (bDocEveryStr, '', все_документы1)

  // С товаром переданы документы. Документы, поставляемые с грузом. 2-я строка.
  if (bDocEveryStr, '', все_документы2)

  // С товаром переданы документы. Документы, поставляемые с грузом. 3-я строка.
  if (bDocEveryStr, '', все_документы3)

  // С товаром переданы документы. Документы, поставляемые с грузом. 4-я строка.
  if (bDocEveryStr, '', все_документы4)

  // С товаром переданы документы. Документы, поставляемые с грузом. 5-я строка.
  if (bDocEveryStr, '', все_документы5)

  // С товаром переданы документы. Сертификаты партий. 1-я строка.
  if (bDocEveryStr, '',
    if (все_сертификаты1 = '', '', ' Сертификаты: ' + все_сертификаты1))

  // С товаром переданы документы. Сертификаты партий. 2-я строка.
  if (bDocEveryStr, '', все_сертификаты2)

  // С товаром переданы документы. Сертификаты партий. 3-я строка.
  if (bDocEveryStr, '', все_сертификаты3)

  // С товаром переданы документы. Сертификаты партий. 4-я строка.
  if (bDocEveryStr, '', все_сертификаты4)

  // С товаром переданы документы. Сертификаты партий. 5-я строка.
  if (bDocEveryStr, '', все_сертификаты5)

  // С товаром переданы документы. Прейскурант цен.
  if (ПрейскурантЦен  = '', '', ' Прейскурант: ' + Trim(ПрейскурантЦен))

  // С товаром переданы документы. Прайс-листы.
  if (bDocEveryStr, '',
    if (все_прайслисты = '', '', все_прайслисты))
//******************************************************************************

  // Символ-разделитель страниц.
  Спецсимвол
