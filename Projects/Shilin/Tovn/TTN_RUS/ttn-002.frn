!Цикл сведений о грузе
.begin
  var _ClassCode: word;
  var piExClass : iExtClass;
  var piExAttr  : iExtAttr;

  iNpp := iNpp + 1;
  //с грузом следуют документы
  if (pClassDocOfGoods <> comp(0))
    RunInterface('Prn_DocOfGoods', pClassDocOfGoods, wClassCodeDocOfGoods,
                                   comp(спецификация2_нрек), sDocOfGoods, '', '', '');
  //код груза и класс груза
  _ClassCode      := piExClass.GetClassCode (coKatMC, 'КОД ГРУЗА');

#ifdef __PrnSoprFunMem__
  FROMKATMCMEM.pNrec := comp(спецификация2_нрек);

  if (FROMKATMCMEM.GetFirst SpSoprMemTTN = tsOk)
    if (FROMKATMCMEM.GetFirst KatMc = tsOk)
    {
      CodeGoods  := piExClass.GetSegName (_ClassCode, FROMKATMCMEM.KatMc.NRec);
      ClassGoods := piExAttr.sGetAttr(coKatMC, FROMKATMCMEM.KatMc.NRec, 'КЛАСС ГРУЗА');
    }


  // вывод грузовых мест в 1-Т со сведениями о грузе
  var tKolGrm2: double;
  tKolGrm2 := FROMKATMCMEM.SpSoprMemTTN.KolGrM;

  //---------------------------------------------------------------------------
  //Количесто грузовых мест
  EdGrM2  := '';
  KolGrM2 := '';

  if (FROMKATMCMEM.GetFirst KatEdGr where (( FROMKATMCMEM.SpSoprMemTTN.cOtpEdGrM == KatEdGr.NRec )) = tsOk)
  {
    EdGrM2  := FROMKATMCMEM.KatEdGr.Name;
    KolGrM2 := DoubleToStr(FROMKATMCMEM.SpSoprMemTTN.KolGrM, RoundGrm);
  }
  else
    if (FROMKATMCMEM.GetFirst KatOtpEd = tsOk)
    {
      EdGrM2  := FROMKATMCMEM.KatOtpEd.Name;
      KolGrM2 := DoubleToStr(FROMKATMCMEM.SpSoprMemTTN.KolFact, RoundGrm);
    }

  if (bAutoGrM)
  {
    KolGrM2 := DoubleToStr(FROMKATMCMEM.SpSoprMemTTN.KolGrM, RoundGrm);

    // если МЦ - тара - выводить прочерки в графах 10-12 ТТН-1, ТН-2; 6-8 ТОРГ-12; 8-9 1-Т
    if (tKolGrm2 = 0)
      if (FROMKATMCMEM.SpSoprMemTTN.cOwner <> comp(0))
      {
        EdGrM2  := '-';
        KolGrM2 := '-';
        EXIT;
      }
  }
  else
    KolGrM2 := DoubleToStr(if (tKolGrm2 <> 0, tKolGrm2, КолФ2), RoundGrm);

  if (FROMKATMCMEM.GetFirst KatOtpEd = tsOk)
  {
    var piExClass  : iExtClass;
    var _ClassCode : word;
    var sMethod    : string;

    _ClassCode := piExClass.GetClassCode (coKatOtpEd, 'СПОСОБ ПЕРЕВОЗКИ Н/У ГРУЗА');
    sMethod    := piExClass.GetSegName   (_ClassCode, FROMKATMCMEM.KatOtpEd.NRec);

    if (sMethod <> '')
    {
      KolGrM2   := 'н/у';
      KolGrM2   := '-';
    }
  }
#else
  FROMKATMC.pNrec := comp(спецификация2_нрек);

  if (FROMKATMC.GetFirst SpSopr = tsOk)
    if (FROMKATMC.GetFirst KatMc = tsOk)
    {
      CodeGoods  := piExClass.GetSegName (_ClassCode, FROMKATMC.KatMc.NRec);
      ClassGoods := piExAttr.sGetAttr(coKatMC, FROMKATMC.KatMc.NRec, 'КЛАСС ГРУЗА');
    }


  // вывод грузовых мест в 1-Т со сведениями о грузе
  var tKolGrm2: double;
  tKolGrm2 := FROMKATMC.SpSopr.KolGrM;

  //---------------------------------------------------------------------------
  //Количесто грузовых мест
  EdGrM2  := '';
  KolGrM2 := '';

  if (FROMKATMC.GetFirst KatEdGr where (( FROMKATMC.SpSopr.cOtpEdGrM == KatEdGr.NRec )) = tsOk)
  {
    EdGrM2  := FROMKATMC.KatEdGr.Name;
    KolGrM2 := DoubleToStr(FROMKATMC.SpSopr.KolGrM, RoundGrm);
  }
  else
    if (FROMKATMC.GetFirst KatOtpEd = tsOk)
    {
      EdGrM2  := FROMKATMC.KatOtpEd.Name;
      KolGrM2 := DoubleToStr(FROMKATMC.SpSopr.KolFact, RoundGrm);
    }

  if (bAutoGrM)
  {
    KolGrM2 := DoubleToStr(FROMKATMC.SpSopr.KolGrM, RoundGrm);

    // если МЦ - тара - выводить прочерки в графах 10-12 ТТН-1, ТН-2; 6-8 ТОРГ-12; 8-9 1-Т
    if (tKolGrm2 = 0)
      if (FROMKATMC.SpSopr.cOwner <> comp(0))
      {
        EdGrM2  := '-';
        KolGrM2 := '-';
        EXIT;
      }
  }
  else
    KolGrM2 := DoubleToStr(if (tKolGrm2 <> 0, tKolGrm2, КолФ2), RoundGrm);

  if (FROMKATMC.GetFirst KatOtpEd = tsOk)
  {
    var piExClass  : iExtClass;
    var _ClassCode : word;
    var sMethod    : string;

    _ClassCode := piExClass.GetClassCode (coKatOtpEd, 'СПОСОБ ПЕРЕВОЗКИ Н/У ГРУЗА');
    sMethod    := piExClass.GetSegName   (_ClassCode, FROMKATMC.KatOtpEd.NRec);

    if (sMethod <> '')
    {
      KolGrM2   := 'н/у';
      KolGrM2   := '-';
    }
  }
#end
end.
