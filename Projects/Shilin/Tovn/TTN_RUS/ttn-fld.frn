!Поля формы 1-Т (ttn.rtf)
.fields
#ifdef _TTN_DOC_600_
#define _TTN_SKL_ORG_
#end
#ifdef _TTN_DOC_ROZN_600_
#define _TTN_SKL_ORG_
#end
 CommonFormHeader
!Шапка накладной
 Ean13ToEanGnivcTTF(GenerateBarCodeEx(coKatSopr, накладная_нрек))
 Номер
 if (Дата=Date(0,0,0),'', LpadCh(String(Day(Дата)),'0',2))
 if (Дата=Date(0,0,0),'', LpadCh(String(Month(Дата) ),'0',2))
 if (Дата=Date(0,0,0),'', String(Year(Дата))) //Year(Дата): 'm:YYYY'

#ifdef _TTN_SKL_ORG_
 if(Грузоотправитель = '',
       oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 2) + ',',
       oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 2) + ','
   )

 if(Грузоотправитель = '',
       #AdrFields(Поставщик) + '(' + Склад +
       if (Склад_Адрес = '', '', ', ' + Склад_Адрес) + ')',
       #AdrFields(Грузоотправитель)
   )

 if(Грузоотправитель = '',  Поставщик_ОКПО, Грузоотправитель_ОКПО)

 if(Грузополучатель = '',
       oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 2) + ',',
       oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 2) + ','
   )

 if(Грузополучатель = '',
       #AdrFields(Поставщик) + '(' + Склад_Пол +
       if (Склад_Пол_Адрес = '', '', ', ' + Склад_Пол_Адрес) + ')',
       #AdrFields(Грузополучатель)
   )

 if(Грузополучатель = '', Поставщик_ОКПО, Грузополучатель_ОКПО)

 oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 0, 2) + ','
 #AdrFields(Поставщик)
 #OrgFieldsBank(Поставщик)
 Поставщик_ОКПО
#else
 oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 2) + ','
 #AdrFields(Грузоотправитель)
 Грузоотправитель_ОКПО

 oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 2) + ','
 #AdrFields(Грузополучатель)
 Грузополучатель_ОКПО

 oPrnSoprFun.GetOrgFullName(накладная_нрек, 4, 1) + ' ' + oPrnSoprFun.GetOrgFullName(накладная_нрек, 4, 2) + ','
 #AdrFieldsUr(Плательщик)
 #OrgFieldsBank(Плательщик)
 Плательщик_ОКПО
#end
!Спецификация
     ValSymb ValSymb
     КодМЦ
     oPrnSoprFun.NastrEdIzm(DoubleToStr(КолУч, Kol_Pr), DoubleToStr(КолФ, Kol_Pr))
  #ifdef _IN_VAL_DOC_
   DoubleToStr(oPrnSoprFun.NastrEdIzmP(спецификацияМЦ_нрек, 0, Признак_МЦ, ЦНакСН, ЦНакБН, ЦНакСН, ЦНакБН, ЦНакСНУч, ЦНакБНУч, ЦНакСНУч, ЦНакБНУч), if (GetPrecisionGroup('brForSoprTTN_RVprice') <> 5, Cena_PrTTN, Cena_Pr))
#else
   DoubleToStr(oPrnSoprFun.NastrEdIzmP(спецификацияМЦ_нрек, 0, Признак_МЦ, ЦНацСН, ЦНацБН, ЦНацСН, ЦНацБН, ЦНацСНУч, ЦНацБНУч, ЦНацСНУч, ЦНацБНУч), if (GetPrecisionGroup('brForSoprTTN_RPrice')  <> 5, Cena_PrRTTN, Cena_PrR))
  #end
     Название
     oPrnSoprFun.NastrEdIzm(УчЕд, ОтпЕд)
     if (ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ <> '', ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ, ОтпЕд)
     if (KolGrM = '-', KolOneGrM, KolGrM)
     DoubleToStr((МассаМЦ+МассаТарыМЦ)/1000* КолУч, Massa_Tn)
  #ifdef _IN_VAL_DOC_
     DoubleToStr(СтНак,Cena_Pr)
  #else
     DoubleToStr(СтНац,Cena_PrR)
  #end
!.}
!Итоговые суммы
  DoubleToStr (CountPoz,  '4\m')
  MassaInWords (MassaNetItog, wRoundMass2)
  DoubleToStr (CountPoz,  '4\m')
  DoubleToStr (MassaNetItog / 1000, Massa_Tn)
  DoubleToStr (Round(CountKolF, KolZn), strDr)
  MassaInWords (MassaBrItog, wRoundMass2)
  DoubleToStr (MassaBrItog / 1000, Massa_Tn)
  DoubleToStr (АСтНацСН,Cena_PrR)

  НомерДовер  if (ДатаДовер=Date(0,0,0),'', DateToStr(ДатаДовер,'DD Mon YYYY г.'))

#ifdef _IN_VAL_DOC_
  DoubleToString(Валюта_нрек, Round(АСтНацСН, GetPrecisionGroup('brForSopr_RVPrice')))
#else
  DoubleToString(comp(0), Round(АСтНацСН, GetPrecisionGroup('brForSopr_Price')))
#end

  oPrnSoprFun.GetOrgFullName(накладная_нрек, 6, 0)

  if (НомерДовер <> '' and ДовЛицоДолжность <> '', ДовЛицоДолжность,
    if (экспедитор <> '','Экспедитор',
      if (водитель <> '', 'Водитель', '')))

  if (НомерДовер <> '' and ФИОДовер <>'', ФИОДовер,
    if (экспедитор <> '', экспедитор,
      if (водитель <> '', водитель, '')))

#ifdef _TTN_PRIH_
  отпуск_разрешил_должность2 отпуск_разрешил2
#else
  отпуск_разрешил_должность отпуск_разрешил
#end
  Главный_Бухгалтер
#ifdef _TTN_PRIH_
  отпуск_разрешил_должность3 отпуск_разрешил3
#else
  сдал_отправитель_должность сдал_отправитель
#end

!Товарно-транспортная информация
  Номер
  ТТН_Номер_ПЛист
  if (Trim(ТТН_АвтоОрг_Адрес) <> ''
    , ТТН_АвтоОрг_Имя
    + if (ТТН_АвтоОрг_Адрес     <>'', ' Адрес:' + ТТН_АвтоОрг_Адрес    , '')
    + if (ТТН_АвтоОрг_ТЕЛ       <>'', ' тел.:'  + ТТН_АвтоОрг_ТЕЛ      , '')
    + if (ТТН_АвтоОрг_БАНК_Имя  <>'', ' Банк:'  + ТТН_АвтоОрг_БАНК_Имя , '')
    + if (ТТН_АвтоОрг_БАНК_Счет <>'', ' р/с '   + ТТН_АвтоОрг_БАНК_Счет, '')
    + if (ТТН_АвтоОрг_БАНК_Мфо  <>'', mfo_      + ТТН_АвтоОрг_БАНК_Мфо , '')
    , Автопредприятие_назв)

  if (Trim(ТТН_Авто_Номер) <> '', ТТН_Авто_Марка, автомобиль)
  if (Trim(ТТН_Авто_Номер) <> '', ТТН_Авто_Номер, '')

  Заказчик_Плательщик
    + if (Заказчик_Плательщик_Адрес     <>'', ' Адрес:' + if (wGetTune('Doc.SD.PrnNakl.PlatAdr') = 0, Заказчик_Плательщик_ЮрАдрес, Заказчик_Плательщик_Адрес)    , '')
    + if (Заказчик_Плательщик_ТЕЛ       <>'', ' тел.:'  + Заказчик_Плательщик_ТЕЛ      , '')
    + if (Заказчик_Плательщик_БАНК_Имя  <>'', ' Банк:'  + Заказчик_Плательщик_БАНК_Имя , '')
    + if (Заказчик_Плательщик_БАНК_Счет <>'', ' р/с '   + Заказчик_Плательщик_БАНК_Счет, '')
    + if (Заказчик_Плательщик_БАНК_Мфо  <>'', mfo_      + Заказчик_Плательщик_БАНК_Мфо , '')

  if (Trim(ТТН_Водитель_НомерУдост) <> '', ТТН_Водитель_Имя       , водитель)
  if (Trim(ТТН_Водитель_НомерУдост) <> '', ТТН_Водитель_НомерУдост, '')

 ТТН_Маршрут_Имя
 DelDblStr(#PunktFields(ТТН_ПунктП),', ',true)
 DelDblStr(#PunktFields(ТТН_ПунктР),', ',true)

 ТТН_Прицеп1_НомерГараж ТТН_Прицеп1_Марка  ТТН_Прицеп1_Номер
 ТТН_Прицеп2_НомерГараж ТТН_Прицеп2_Марка  ТТН_Прицеп2_Номер
!Сведения о грузе
#ifdef _TTN_GR_INFO_
     string(iNpp) + '. ' + Название2
     sDocOfGoods
     EdGrM2
     KolGrM2
     СпособОпрВеса2
     CodeGoods
     ClassGoods
     DoubleToStr((МассаМЦ2 + МассаТарыМЦ2)/1000* КолУч2, Massa_Tn)
#end
!Итоговые суммы
 DoubleToStr (MassaBrItog / 1000, Massa_Tn)
 DoubleToStr (Round(CountKolF, KolZn), strDr)
 DoubleToStr (Round(CountKolF, KolZn), strDr)
 MassaInWords (MassaBrItog, wRoundMass2)
 MassaInWords (MassaBrItog, wRoundMass2)
 сдал_отправитель_должность сдал_отправитель
 Экспедитор
 транспортная_услуга_1
 Экспедитор
 транспортная_услуга_2
!Погрузочно-разгрузочные операции
 ТТН_ПунктП_Орг_Имя
 ТТН_ПунктП_Доп_Имя + if(Round(ТТН_ПунктП_Доп_Колич)<>0, ', '+doubletostr(ТТН_ПунктП_Доп_Колич, '666666666666666'), '')
 ТТН_ПунктП_Метод
 If( ТТН_ПунктП_Дата_С = Date(0,0,0),'', DateToStr(ТТН_ПунктП_Дата_С,'DD/MM/YY'))
 If((ТТН_ПунктП_Время_С = string(Time(0, 0, 0, 0))) and
    (ТТН_ПунктП_Дата_С  = Date(0,0,0)),'', ТТН_ПунктП_Время_С)
 If(ТТН_ПунктП_Дата_По = Date(0,0,0),'', DateToStr(ТТН_ПунктП_Дата_По,'DD/MM/YY'))
 If((ТТН_ПунктП_Время_По = string(Time(0, 0, 0, 0))) and
    (ТТН_ПунктП_Дата_По  = Date(0,0,0)),'', ТТН_ПунктП_Время_По)
 If(ТТН_ПунктП_Доп_Время = string(Time(0, 0, 0, 0)),'', ТТН_ПунктП_Доп_Время)
 ТТН_ПунктР_Орг_Имя

 ValSymb ValSymb ValSymb
 СпецСимвол
#ifdef _TTN_SKL_ORG_
#undef _TTN_SKL_ORG_
#end
.endfields
