.begin
  if (NOT isTTN_Fast)
    Exit;

  var koef, sNDS : double;

#ifdef __PrnSoprFunMem__
  if FASTREPORTMEM.getfirst SpSoprMemTTN where ((спецификацияМЦ_нрек == SpSoprMemTTN.Nrec)) <> tsOk
    Exit;

  if (FASTREPORTMEM.SpSoprMemTTN.PrMc = 1)
  {
    if FASTREPORTMEM.getfirst KatMC  where ((FASTREPORTMEM.SpSoprMemTTN.cMCUSL == KatMC.Nrec )) <> tsOK
      Exit;
  }
  else
    if FASTREPORTMEM.getfirst KatUsl where ((FASTREPORTMEM.SpSoprMemTTN.cMCUSL == KatUsl.Nrec )) <> tsOK
      Exit;

    Дополнительная_информация := MCDopInfo [FASTREPORTMEM.SpSoprMemTTN.Npp];
  #ifdef _TTN_ALC_
    страна_ввоза              := MCStrana  [FASTREPORTMEM.SpSoprMemTTN.Npp];
  #end

  Название    :=  if (FASTREPORTMEM.SpSoprMemTTN.PrMc = 1, FASTREPORTMEM.KatMC.Name, FASTREPORTMEM.KatUsl.Name);
  КолФ        :=  FASTREPORTMEM.SpSoprMemTTN.KolFact;
  КолОпл      :=  FASTREPORTMEM.SpSoprMemTTN.KolOpl;

  if (FASTREPORTMEM.SpSoprMemTTN.PrMc = 1)
    case KatSoprVidSopr of
      521,522,523,600..606,106,206:
      {
         МассаМц     :=  FASTREPORTMEM.KatMc.Massa;
         МассаТарыМц :=  FASTREPORTMEM.KatMc.MTara;
      }
      else
      {
        МассаМц     :=  FASTREPORTMEM.SpSoprMemTTN.Netto;
        МассаТарыМц :=  FASTREPORTMEM.SpSoprMemTTN.MTara;
      }
    end;

 #ifdef _IN_VAL_DOC_
  if Валюта_нрек <> comp(0)
    СтНак := FASTREPORTMEM.SpSoprMemTTN.VPrice * КолФ
  else
    СтНак := FASTREPORTMEM.SpSoprMemTTN.Price * КолФ;
 #else
  СтНац := FASTREPORTMEM.SpSoprMemTTN.Price * КолФ;
 #end

  if FASTREPORTMEM.getfirst KatOtpEd where ((FASTREPORTMEM.SpSoprMemTTN.cOtpEd == KatOtpEd.NRec)) = tsOK
  {
    koef  := if (FASTREPORTMEM.KatOtpEd.koef = 0, 1, FASTREPORTMEM.KatOtpEd.koef);
    ОтпЕд := FASTREPORTMEM.KatOtpEd.Name
  }
  else
    koef := 1;

  КолВес := КолФ * Koef * (FASTREPORTMEM.KatMC.Massa + FASTREPORTMEM.KatMC.mTara);

  if FASTREPORTMEM.getfirst KatEd where (( if (FASTREPORTMEM.SpSoprMemTTN.PrMc = 1,
                                               FASTREPORTMEM.KatMC.cEd,
                                               FASTREPORTMEM.KatUsl.cEd) == KatEd.NRec )) = tsOK
    УчЕд := FASTREPORTMEM.KatEd.Name;


    sNDS := 0;

    if FASTREPORTMEM.GetFirst SpDocNalMemTTN where (( спецификацияМЦ_нрек == SpDocNalMemTTN.cSpDoc   and
                                                      KatSoprVidSopr      == SpDocNalMemTTN.TipDoc )) = tsOk
      do
      {
        if (FASTREPORTMEM.SpDocNalMemTTN.cNalog = NalogNDS) //эту переменную нужно определить и вычислить в форме
        {
          ПризнакНДС:= 1;
          ставка_первого_налога := FASTREPORTMEM.SpDocNalMemTTN.Nalog;
         #ifdef _IN_VAL_DOC_
          if Валюта_нрек <> comp(0)
            sNDS := sNDS + FASTREPORTMEM.SpDocNalMemTTN.SumVal
          else
            sNDS := sNDS + FASTREPORTMEM.SpDocNalMemTTN.Summa;
         #else
          sNDS := sNDS + FASTREPORTMEM.SpDocNalMemTTN.Summa;
         #end
        }
      }
      while FASTREPORTMEM.GetNext SpDocNalMemTTN where ((спецификацияМЦ_нрек == SpDocNalMemTTN.cSpDoc  and
                                                         KatSoprVidSopr      == SpDocNalMemTTN.TipDoc )) = tsOk

     #ifdef _IN_VAL_DOC_
      if Валюта_нрек <> comp(0)
        СтНДСНак := sNDS
      else
        СтНДСНак := sNDS;
     #else
      СтНДСНац0 := sNDS;
     #end


  КодМЦ :=  if (FASTREPORTMEM.SpSoprMemTTN.PrMc = 1, FASTREPORTMEM.KatMC.BarKod, FASTREPORTMEM.KatUsl.Kod);
  КолУч :=  КолФ * koef;

 #ifdef _IN_VAL_DOC_
  if Валюта_нрек <> comp(0)
  {
    ЦНакБНУч   :=  FASTREPORTMEM.SpSoprMemTTN.VPrice / koef;
    СтНакСН    :=  FASTREPORTMEM.SpSoprMemTTN.VPrice * КолФ
  }
  else
  {
    ЦНакБНУч   :=  FASTREPORTMEM.SpSoprMemTTN.Price / koef;
    СтНакСН    :=  FASTREPORTMEM.SpSoprMemTTN.Price * КолФ;
  }
 #else
  ЦНацБНУч   :=  FASTREPORTMEM.SpSoprMemTTN.Price / koef;
  СтНацСН0   :=  FASTREPORTMEM.SpSoprMemTTN.Price * КолФ;
 #end

    #ifdef _IN_VAL_DOC_
    if Валюта_нрек <> comp(0)
      СтНакБН    :=  FASTREPORTMEM.SpSoprMemTTN.VPrice * КолФ
    else
      СтНакБН    :=  FASTREPORTMEM.SpSoprMemTTN.Price * КолФ;
   #else
    СтНацБН0   :=  FASTREPORTMEM.SpSoprMemTTN.Price * КолФ;
   #end

  if (КолФ <> 0)
    if (KatSoprVhodNal = 1) //эту переменную нужно определить и вычислить в форме
    {
     #ifdef _IN_VAL_DOC_
      if Валюта_нрек <> comp(0)
        ЦНакБНУч := FRoundVal2 ((FASTREPORTMEM.SpSoprMemTTN.VPrice -
                                 FASTREPORTMEM.SpSoprMemTTN.SumVNDS/КолФ)/koef);
      else
        ЦНакБНУч := FRoundRub2 ((FASTREPORTMEM.SpSoprMemTTN.Price -
                                 FASTREPORTMEM.SpSoprMemTTN.SumNDS/КолФ)/koef);

     #else
      {
        ЦНацБНУч := FRoundRub2 ((FASTREPORTMEM.SpSoprMemTTN.Price -
                                 FASTREPORTMEM.SpSoprMemTTN.SumNDS/КолФ)/koef);
        ЦНацСН := FASTREPORTMEM.SpSoprMemTTN.Price;
      }
     #end

       #ifdef _IN_VAL_DOC_
        if Валюта_нрек <> comp(0)
          СтНакБН  := FRoundVal2 (СтНакБН - FASTREPORTMEM.SpSoprMemTTN.SumVNDS);
        else
          СтНакБН  := FRoundRub2 (СтНакБН - FASTREPORTMEM.SpSoprMemTTN.SumNDS);
     #else
        СтНацБН0 := FRoundRub2 (СтНацБН0 - FASTREPORTMEM.SpSoprMemTTN.SumNDS);
     #end
    }
    else
    {
     #ifdef _IN_VAL_DOC_
      if Валюта_нрек <> comp(0)
        СтНакСН  := FRoundVal2 (СтНакСН + FASTREPORTMEM.SpSoprMemTTN.SumVNDS);
      else
        СтНакСН  := FRoundRub2 (СтНакСН + FASTREPORTMEM.SpSoprMemTTN.SumNDS);
     #else
      СтНацСН0 := FRoundRub2 (СтНацСН0 + FASTREPORTMEM.SpSoprMemTTN.SumNDS);
      ЦНацСН := FASTREPORTMEM.SpSoprMemTTN.Price + FASTREPORTMEM.SpSoprMemTTN.SumNDS/КолФ;
     #end
    }


    КОЛ_ГРУЗОВЫХ_МЕСТ := FASTREPORTMEM.SpSoprMemTTN.KolGrM;

    if FASTREPORTMEM.getfirst KatOtpEd where ((FASTREPORTMEM.SpSoprMemTTN.cOtpEdGRM == KatOtpEd.NRec)) = tsOK
    {
      ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ := FASTREPORTMEM.KatOtpEd.Name;

      var piExAttr  : iExtAttr;

      КОЭФФИЦИЕНТ_ГРУЗОВЫХ_МЕСТ  := double(piExAttr.sGetAttr(coKatOtpEd, FASTREPORTMEM.KatOtpEd.NRec,'ГРУЗОВЫЕ МЕСТА, КОЭФФИЦИЕНТ'));
    }

    if FASTREPORTMEM.getfirst KatParty where ((FASTREPORTMEM.SpSoprMemTTN.cParty == KatParty.NRec)) = tsOK
      Номер_сертификата := FASTREPORTMEM.KatParty.NSertif
#else
  if FASTREPORT.getfirst SpSopr where ((спецификацияМЦ_нрек == SpSopr.Nrec)) <> tsOk
    Exit;

  if (FASTREPORT.SpSopr.PrMc = 1)
  {
    if FASTREPORT.getfirst KatMC  where ((FASTREPORT.SpSopr.cMCUSL == KatMC.Nrec )) <> tsOK
      Exit;
  }
  else
    if FASTREPORT.getfirst KatUsl where ((FASTREPORT.SpSopr.cMCUSL == KatUsl.Nrec )) <> tsOK
      Exit;

    Дополнительная_информация := MCDopInfo [FASTREPORT.SpSopr.Npp];
  #ifdef _TTN_ALC_
    страна_ввоза              := MCStrana  [FASTREPORT.SpSopr.Npp];
  #end

  Название    :=  if (FASTREPORT.SpSopr.PrMc = 1, FASTREPORT.KatMC.Name, FASTREPORT.KatUsl.Name);
  КолФ        :=  FASTREPORT.SpSopr.KolFact;
  КолОпл      :=  FASTREPORT.SpSopr.KolOpl;

  if (FASTREPORT.SpSopr.PrMc = 1)
    case KatSoprVidSopr of
      521,522,523,600..606,106,206:
      {
         МассаМц     :=  FASTREPORT.KatMc.Massa;
         МассаТарыМц :=  FASTREPORT.KatMc.MTara;
      }
      else
      {
        МассаМц     :=  FASTREPORT.SpSopr.Netto;
        МассаТарыМц :=  FASTREPORT.SpSopr.MTara;
      }
    end;

 #ifdef _IN_VAL_DOC_
  if Валюта_нрек <> comp(0)
    СтНак := FASTREPORT.SpSopr.VPrice * КолФ
  else
    СтНак := FASTREPORT.SpSopr.Price * КолФ;
 #else
  СтНац := FASTREPORT.SpSopr.Price * КолФ;
 #end

  if FASTREPORT.getfirst KatOtpEd where ((FASTREPORT.SpSopr.cOtpEd == KatOtpEd.NRec)) = tsOK
  {
    koef  := if (FASTREPORT.KatOtpEd.koef = 0, 1, FASTREPORT.KatOtpEd.koef);
    ОтпЕд := FASTREPORT.KatOtpEd.Name
  }
  else
    koef := 1;

  КолВес := КолФ * Koef * (FASTREPORT.KatMC.Massa + FASTREPORT.KatMC.mTara);

  if FASTREPORT.getfirst KatEd where (( if (FASTREPORT.SpSOpr.PrMc = 1,
                                            FASTREPORT.KatMC.cEd,
                                            FASTREPORT.KatUsl.cEd) == KatEd.NRec )) = tsOK
    УчЕд := FASTREPORT.KatEd.Name;


    sNDS := 0;

    if FASTREPORT.GetFirst SpDocNal where (( спецификацияМЦ_нрек == SpDocNal.cSpDoc   and
                                             KatSoprVidSopr      == SpDocNal.TipDoc )) = tsOk
      do
      {
        if FASTREPORT.SpDocNal.cNalog = NalogNDS //эту переменную нужно определить и вычислить в форме
        {
          ПризнакНДС:= 1;
          ставка_первого_налога := FASTREPORT.SpDocNal.Nalog;
         #ifdef _IN_VAL_DOC_
          if Валюта_нрек <> comp(0)
            sNDS := sNDS + FASTREPORT.SpDocNal.SumVal
          else
            sNDS := sNDS + FASTREPORT.SpDocNal.Summa;
         #else
          sNDS := sNDS + FASTREPORT.SpDocNal.Summa;
         #end
        }
      }
      while FASTREPORT.GetNext SpDocNal where ((спецификацияМЦ_нрек == SpDocNal.cSpDoc  and
                                                KatSoprVidSopr      == SpDocNal.TipDoc )) = tsOk

     #ifdef _IN_VAL_DOC_
      if Валюта_нрек <> comp(0)
        СтНДСНак := sNDS
      else
        СтНДСНак := sNDS;
     #else
      СтНДСНац0 := sNDS;
     #end


  КодМЦ :=  if (FASTREPORT.SpSOpr.PrMc = 1, FASTREPORT.KatMC.BarKod, FASTREPORT.KatUsl.Kod);
  КолУч :=  КолФ * koef;

 #ifdef _IN_VAL_DOC_
  if Валюта_нрек <> comp(0)
  {
    ЦНакБНУч   :=  FASTREPORT.SpSopr.VPrice / koef;
    СтНакСН    :=  FASTREPORT.SpSopr.VPrice * КолФ
  }
  else
  {
    ЦНакБНУч   :=  FASTREPORT.SpSopr.Price / koef;
    СтНакСН    :=  FASTREPORT.SpSopr.Price * КолФ;
  }
 #else
  ЦНацБНУч   :=  FASTREPORT.SpSopr.Price / koef;
  СтНацСН0   :=  FASTREPORT.SpSopr.Price * КолФ;
 #end

    #ifdef _IN_VAL_DOC_
    if Валюта_нрек <> comp(0)
      СтНакБН    :=  FASTREPORT.SpSopr.VPrice * КолФ
    else
      СтНакБН    :=  FASTREPORT.SpSopr.Price * КолФ;
   #else
    СтНацБН0   :=  FASTREPORT.SpSopr.Price * КолФ;
   #end

  if (КолФ <> 0)
    if (KatSoprVhodNal = 1) //эту переменную нужно определить и вычислить в форме
    {
     #ifdef _IN_VAL_DOC_
      if Валюта_нрек <> comp(0)
        ЦНакБНУч := FRoundVal2 ((FASTREPORT.SpSopr.VPrice -
                                 FASTREPORT.SpSopr.SumVNDS/КолФ)/koef);
      else
        ЦНакБНУч := FRoundRub2 ((FASTREPORT.SpSopr.Price -
                                 FASTREPORT.SpSopr.SumNDS/КолФ)/koef);

     #else
      {
        ЦНацБНУч := FRoundRub2 ((FASTREPORT.SpSopr.Price -
                                 FASTREPORT.SpSopr.SumNDS/КолФ)/koef);
        ЦНацСН := FASTREPORT.SpSopr.Price;
      }
     #end

       #ifdef _IN_VAL_DOC_
        if Валюта_нрек <> comp(0)
          СтНакБН  := FRoundVal2 (СтНакБН - FASTREPORT.SpSopr.SumVNDS);
        else
          СтНакБН  := FRoundRub2 (СтНакБН - FASTREPORT.SpSopr.SumNDS);
     #else
        СтНацБН0 := FRoundRub2 (СтНацБН0 - FASTREPORT.SpSopr.SumNDS);
     #end
    }
    else
    {
     #ifdef _IN_VAL_DOC_
      if Валюта_нрек <> comp(0)
        СтНакСН  := FRoundVal2 (СтНакСН + FASTREPORT.SpSopr.SumVNDS);
      else
        СтНакСН  := FRoundRub2 (СтНакСН + FASTREPORT.SpSopr.SumNDS);
     #else
      СтНацСН0 := FRoundRub2 (СтНацСН0 + FASTREPORT.SpSopr.SumNDS);
      ЦНацСН := FASTREPORT.SpSopr.Price + FASTREPORT.SpSopr.SumNDS/КолФ;
     #end
    }


    КОЛ_ГРУЗОВЫХ_МЕСТ := FASTREPORT.SpSopr.KolGrM;

    if FASTREPORT.getfirst KatOtpEd where ((FASTREPORT.SpSopr.cOtpEdGRM == KatOtpEd.NRec)) = tsOK
    {
      ЕД_ИЗМЕРЕНИЯ_ГРУЗОВЫХ_МЕСТ := FASTREPORT.KatOtpEd.Name;

      var piExAttr  : iExtAttr;

      КОЭФФИЦИЕНТ_ГРУЗОВЫХ_МЕСТ  := double(piExAttr.sGetAttr(coKatOtpEd, FASTREPORT.KatOtpEd.NRec,'ГРУЗОВЫЕ МЕСТА, КОЭФФИЦИЕНТ'));
    }

    if FASTREPORT.getfirst KatParty where ((FASTREPORT.SpSopr.cParty == KatParty.NRec)) = tsOK
      Номер_сертификата := FASTREPORT.KatParty.NSertif
#end
end.
